<!DOCTYPE html>
<html>
<head>
    <title>Test localStorage</title>
</head>
<body>
    <h1>MarkReview Settings Test</h1>
    <div id="output"></div>
    
    <script>
        const output = document.getElementById('output');
        
        // Check if settings exist
        const settingsKey = 'markreview-settings';
        const settings = localStorage.getItem(settingsKey);
        
        if (settings) {
            try {
                const parsed = JSON.parse(settings);
                output.innerHTML += '<h3>Current Settings:</h3><pre>' + JSON.stringify(parsed, null, 2) + '</pre>';
                
                if (parsed.window) {
                    output.innerHTML += '<h3>Window Settings Found:</h3>';
                    output.innerHTML += '<p>Width: ' + parsed.window.width + '</p>';
                    output.innerHTML += '<p>Height: ' + parsed.window.height + '</p>';
                    output.innerHTML += '<p>X: ' + parsed.window.x + '</p>';
                    output.innerHTML += '<p>Y: ' + parsed.window.y + '</p>';
                    output.innerHTML += '<p>Maximized: ' + parsed.window.maximized + '</p>';
                } else {
                    output.innerHTML += '<p style="color: red;">No window settings found!</p>';
                }
            } catch (e) {
                output.innerHTML += '<p style="color: red;">Error parsing settings: ' + e.message + '</p>';
            }
        } else {
            output.innerHTML += '<p style="color: orange;">No settings found in localStorage</p>';
        }
        
        // Test setting window settings
        const testSettings = {
            theme: 'solarized-dark',
            editor: { fontSize: 14, fontFamily: 'Monaco', tabSize: 2, wordWrap: true },
            preview: { syncScroll: true },
            window: { width: 1400, height: 900, x: 100, y: 50, maximized: false },
            shortcuts: {}
        };
        
        output.innerHTML += '<br><button onclick="saveTest()">Save Test Settings</button>';
        output.innerHTML += '<button onclick="clearSettings()">Clear Settings</button>';
        
        window.saveTest = function() {
            localStorage.setItem(settingsKey, JSON.stringify(testSettings));
            location.reload();
        };
        
        window.clearSettings = function() {
            localStorage.removeItem(settingsKey);
            location.reload();
        };
    </script>
</body>
</html>